# 📊 澄清國際眼科醫院工時分析系統升級

## 技術調研報告與實施建議

**報告日期**：2026年1月4日
**調研對象**：Checkinly 工時分析系統功能擴充計畫
**預計時程**：第一階段於 2026年3月下旬完成
**調研人員**：開發團隊（配合 Claude Code 技術支援）

---

## 📋 目錄

1. [執行摘要](#一執行摘要)
2. [核心指標學術調研](#二核心指標學術調研)
3. [現有資料欄位分析](#三現有資料欄位分析)
4. [ESS 平台功能調研](#四ess-平台功能調研)
5. [功能擴充優先級排序](#五功能擴充優先級排序)
6. [What-If 分析可行性評估](#六what-if-分析可行性評估)
7. [EAP 系統釋義與整合方案](#七eap-系統釋義與整合方案)
8. [實施時程與資源評估](#八實施時程與資源評估)
9. [建議與結論](#九建議與結論)

---

## 一、執行摘要

本報告針對 Gemini Research 提供的 EAP 儀表板範例進行深度技術調研，評估各項功能指標的學術依據、資料來源可行性，以及在澄清國際眼科醫院的實施可行性。

### 🎯 核心發現

| 發現類別 | 結論 |
|---------|------|
| **Bradford Factor** | ✅ 有國際標準公式，可立即實施 |
| **VFLI（視覺負荷指標）** | ❌ 無學術標準，為研究文件自創指標 |
| **MBI 倦怠量表** | ✅ 有國際標準但需額外問卷調查 |
| **EAP 系統** | ⚠️ 無開源專案，可用 ESS 部分替代 |
| **What-If 預測** | ⚠️ 有ML模型但需大量開發資源 |

---

## 二、核心指標學術調研

### 2.1 Bradford Factor（缺勤指數）✅ **可實施**

#### 📚 學術依據
- **來源**：英國 HR 管理標準實務（Bradford University Research）
- **公式**：`Bradford Score = S² × D`
  - S = 缺勤次數（Spells of absence）
  - D = 缺勤總天數（Days of absence）
  - 計算期間：通常為滾動式 52 週

#### 💡 解釋邏輯
此公式**強調頻繁短期缺勤**比長期請假對組織更具破壞性。例如：
- 1次請10天病假 = `1² × 10 = 10分`
- 5次各請2天病假 = `5² × 10 = 250分`（同樣10天，但分數高25倍）

#### 📊 標準門檻值（UK HR Standard）
```yaml
0-50分:    正常範圍，無需關注
51-200分:  需監控，可能需要非正式對話
201-500分: 高風險，需正式HR介入或支持
500分以上: 極高風險，需採取紀律行動或深入關懷
```

#### 📌 資料來源評估
**目前資料欄位是否足夠？** ✅ **是的**

現有 Excel 欄位可直接計算：
```
狀態欄位：排休、事假、病假、公假等
→ 統計「病假」次數與天數即可計算 Bradford Score
```

#### ⚠️ 重要提醒
2024年研究指出，Bradford Factor 不應單獨作為懲處依據，因為它**無法區分**：
- 慢性疾病（如癲癇、氣喘）導致的頻繁短期缺勤
- 癌症等重大疾病

**建議用途**：作為**關懷觸發機制**而非懲戒工具。

#### 📖 參考資料
- [IRIS HR: What is the Bradford Factor?](https://www.iris.co.uk/blog/hr/absence-management-what-is-the-bradford-factor/)
- [Bradford Factor Calculator | Breathe](https://www.breathehr.com/en-gb/bradford-factor-calculator)
- [Wikipedia: Bradford Factor](https://en.wikipedia.org/wiki/Bradford_Factor)

---

### 2.2 VFLI（視覺負荷指標）❌ **無學術依據**

#### 🔍 調研結果
經過文獻檢索（PubMed, Google Scholar, Frontiers in Neuroscience），**未找到任何名為"Visual Fatigue Load Index (VFLI)"的標準指標**。

搜尋結果顯示相關但不同的概念：
- **VFI (Visual Field Index)**：用於青光眼視野損傷評估，與疲勞無關
- **Visual Fatigue Scales**：主觀問卷評估（如SSQ），非定量指標
- **眼動追蹤疲勞評估**：測量瞳孔調節速度、眨眼頻率等

#### 💭 推測
Gemini 研究文件中的VFLI 可能是：
1. **自創指標**：`手術量 × 精密度係數`
2. **理論概念**：尚無實證研究支持

#### ⚠️ 風險評估
- ❌ 無法引用學術論文支持
- ❌ 計算公式缺乏醫學驗證
- ❌ 不適用於國際醫院的公信力要求

#### ✅ 替代方案
如需評估眼科醫護視覺疲勞，建議採用：
1. **標準問卷**：使用已驗證的 Visual Fatigue Questionnaire
2. **眼動追蹤設備**：Tobii Eye Tracker 等商用設備
3. **工時相關指標**：直接使用「連續顯微鏡使用時數」作為代理變數

#### 📖 參考資料
- [PMC: Visual impairment and fatigue meta-analysis](https://pmc.ncbi.nlm.nih.gov/articles/PMC6899802/)
- [Frontiers: Visual fatigue in VR games](https://www.frontiersin.org/journals/neuroscience/articles/10.3389/fnins.2023.1173127/full)

---

### 2.3 MBI 倦怠風險評估 ✅ **可實施但需額外問卷**

#### 📚 學術依據
**Maslach Burnout Inventory（MBI）**是職業倦怠評估的**國際金標準**，由心理學家 Christina Maslach 於1981年開發。

#### 📋 MBI-HSS (MP) 醫療人員版本
- **題目數**：22題
- **三大維度**：
  1. **情緒耗竭（Emotional Exhaustion, EE）**：9題
  2. **去人性化（Depersonalization, DP）**：5題
  3. **個人成就感低落（Personal Accomplishment, PA）**：8題
- **評分方式**：7點李克特量表（0=從未，6=每天）

#### 🎯 倦怠判定標準
```yaml
高倦怠定義:
  - EE分數 > 26分（高情緒耗竭）
  - DP分數 > 12分（高去人性化）
  - PA分數 < 34分（低成就感）
```

#### 📌 資料來源評估
**目前資料欄位是否足夠？** ❌ **不足，需額外蒐集**

MBI 需要員工填寫問卷，**無法從出勤紀錄直接計算**。

#### 💰 版權與成本
- MBI 為**商業量表**，需向 Mind Garden 購買授權
- 授權費用：每份問卷約 $2-5 USD（依數量而定）
- 不可自行修改或免費使用

#### ✅ 實施方案
**選項A：購買正版MBI**
- 優點：有學術公信力，可發表研究
- 缺點：需支付版權費、員工需額外填寫問卷

**選項B：使用免費替代量表**
- Copenhagen Burnout Inventory（CBI）：免費開源
- Oldenburg Burnout Inventory（OLBI）：免費開源
- 優點：無版權費用
- 缺點：引用文獻較少，公信力略低於MBI

**選項C：簡化版倦怠評估**
- 使用**單題問卷**："Overall, based on your definition of burnout, how would you rate your level of burnout?"（史丹佛研究驗證）
- 優點：快速、每日可詢問（ESS 簽到時一併填寫）
- 缺點：缺乏多維度分析

#### 📖 參考資料
- [Mind Garden: MBI Official Website](https://www.mindgarden.com/117-maslach-burnout-inventory-mbi)
- [PMC: MBI Psychometric Properties](https://pmc.ncbi.nlm.nih.gov/articles/PMC8829575/)
- [NAM: Valid Survey Instruments for Burnout](https://nam.edu/valid-reliable-survey-instruments-measure-burnout-well-work-related-dimensions/)

---

### 2.4 心情指數 ⚠️ **可實施（已有ESS平台）**

#### 💡 常見作法
企業常用「每日心情打卡」功能，通常為：
- **1-10分**量表或**表情符號**（😡😐😊😄）
- 在簽到/簽退時順便勾選

#### 📌 資料來源評估
**ESS 平台是否已有此功能？** 需查看 ESS 原始碼確認

從檔案結構看到：
```
/OvertimeApply/  （加班申請）
/Attendance/     （出勤管理）
```

**建議**：若 ESS 尚無此功能，可透過以下方式新增：
1. **最小實作**：在 ESS 簽到頁面加入下拉選單（心情1-10分）
2. **API 串接**：工時分析系統透過 API 讀取心情資料
3. **匿名化處理**：避免主管直接看到個別員工的每日心情（隱私考量）

---

### 2.5 台灣勞基法排班合規預警 ✅ **有明確法規依據**

#### 📜 法規依據

##### **核心法規：勞基法第36條「七休一」原則**
- **每7天**至少應有**2日休息**
  - **1日例假**（不可加班）
  - **1日休息日**（可加班但需給付加成工資）

##### **醫療產業特殊規定**
1. **四週變形工時（勞基法第30-1條）**
   - 醫療保健服務業可採用
   - 4週內總工時 ≤ 160小時
   - 可連續工作最多**12天**（前提：4週內仍保證8天休息）
   - 換班間隔：至少**11小時**（可縮短至8小時但需主管機關核備）

2. **住院醫師工時指引（衛福部 2024）**
   - 每週工時上限：80小時（含值班）
   - 連續工作時間：≤ 28小時

#### 📌 資料來源評估
**目前資料欄位是否足夠？** ✅ **是的**

現有欄位可判斷：
```
日期 + 狀態（排休/正常/加班）
→ 統計連續工作天數
→ 檢查是否違反「七休一」或「4週8休」
```

#### 💻 實施方案
```javascript
// 排班合規檢查邏輯（偽代碼）
function checkSchedulingCompliance(employeeData) {
  const violations = [];

  // 檢查1：七休一
  const consecutiveWorkDays = calculateConsecutiveWork(employeeData);
  if (consecutiveWorkDays >= 7) {
    violations.push({
      type: '違反七休一',
      employee: employeeData.name,
      days: consecutiveWorkDays,
      severity: 'high'
    });
  }

  // 檢查2：四週總工時（醫療業變形工時）
  const fourWeekHours = calculateFourWeekHours(employeeData);
  if (fourWeekHours > 160) {
    violations.push({
      type: '四週工時超過160小時',
      employee: employeeData.name,
      hours: fourWeekHours,
      severity: 'medium'
    });
  }

  // 檢查3：連續工作天數（變形工時最多12天）
  if (consecutiveWorkDays > 12) {
    violations.push({
      type: '連續工作超過12天（即使採四週變形）',
      employee: employeeData.name,
      days: consecutiveWorkDays,
      severity: 'critical'
    });
  }

  return violations;
}
```

#### 📖 參考資料
- [衛福部：護理排班問答與指引](https://www.mohw.gov.tw/dl-47213-037e2918-7f19-443d-9114-5d069559e373.html)
- [勞動部：工時制度及工作彈性化](https://www.mol.gov.tw/1607/28162/28166/28218/28220/32907/)
- [台灣勞基法排班規定懶人包](https://salaryback.com/article/post-how-to-arrange-vacations-under-the-labor-standards-law/)

---

## 三、現有資料欄位分析

### 3.1 Excel 資料結構分析

根據 `data/11401-10.xlsx` 實際分析（2025年1-10月資料）：

#### 📊 現有欄位清單
```yaml
基本資訊:
  - 部門名稱
  - 員工編號
  - 日期
  - 星期
  - 假日屬性（國定假日/工作日）

班別資訊:
  - 班別代碼
  - 班別時間
  - 狀態（排休/正常/事假/病假/特休/公假等）

出勤記錄:
  - 出勤(一): 上班時間、下班時間
  - 出勤(二): 上班時間、下班時間
  - 出勤(三): 上班時間、下班時間

其他記錄:
  - 差勤紀錄
  - 加班紀錄
  - 差勤異常
  - 修改原因

統計數據:
  - 出勤時數
  - 實到工時
  - 曠職(時)
  - 遲到(分鐘)
  - 早退(分鐘)
  - 遲到早退合計(時)
```

### 3.2 欄位用途與意義

| 欄位 | 意義 | 目前使用 | 可衍生指標 |
|------|------|---------|-----------|
| **狀態** | 當日工作狀態 | 圓餅圖呈現 | Bradford Factor（病假統計） |
| **實到工時** | 實際工作時數 | 總工時統計 | 週工時/月工時超標檢測 |
| **加班紀錄** | 加班時數 | Top 5排行 | 疲勞風險評分 |
| **遲到早退** | 出勤異常 | 異常總數 | 紀律性指標 |
| **連續日期** | （需計算） | 無 | **七休一檢查** ✨新增 |
| **缺勤模式** | （需計算） | 無 | **Bradford Score** ✨新增 |

---

## 四、ESS 平台功能調研

### 4.1 ESS 平台架構分析

從 `/mnt/c/Users/user/Documents/Yippine/Program/MediCore/services/eip-ui/` 分析：

#### 🗂️ 核心功能模組
```
已有功能:
├── Attendance/       → 出勤管理
├── OvertimeApply/    → 加班申請
├── BusinessTrip/     → 出差申請
├── LeoOvertime/      → 加班相關
└── definetable/      → 自定義表單系統
```

#### 🔧 技術架構
- **後端**：PHP（使用 AdoDB 資料庫抽象層）
- **前端**：ExtJS（舊版 JavaScript 框架）
- **資料庫**：推測為 MySQL/MariaDB

### 4.2 EAP 與 ESS 的關係釐清

#### ❓ EAP 是什麼？

**EAP = Employee Assistance Program（員工協助方案）**

- **定義**：企業提供給員工的**專業諮詢服務**，協助解決個人問題（心理健康、家庭、財務、法律等）
- **核心服務**：
  - 心理諮商（壓力、憂鬱、焦慮）
  - 法律諮詢（離婚、債務）
  - 財務規劃
  - 家庭問題支援（托育、長照資源轉介）
  - 危機干預（職場暴力、重大事故）

#### 🔄 EAP vs ESS 的差異

| 面向 | **ESS (Employee Self-Service)** | **EAP (Employee Assistance Program)** |
|------|--------------------------------|--------------------------------------|
| **定義** | 員工自助服務平台 | 員工協助諮詢服務 |
| **功能** | 請假、加班申請、薪資查詢、出勤打卡 | 心理諮商、法律諮詢、危機介入 |
| **技術** | IT 系統（網頁/APP） | 人力服務（諮商師、律師） |
| **資料** | 結構化資料（工時、假別） | 個案記錄（高度保密） |
| **提供者** | 公司 IT 部門或 HR 系統廠商 | 專業 EAP 服務商（如鉅微、張老師基金會） |

#### ⚠️ 重要結論

**ESS 無法完全取代 EAP**，但可以整合部分功能：

```yaml
ESS 可以做的 EAP 相關功能:
  ✅ 心情指數每日打卡
  ✅ 倦怠問卷填寫（MBI/CBI）
  ✅ 預約 EAP 諮商時段（預約系統）
  ✅ 查看 EAP 資源清單（文章、影片）

ESS 不能做的（需外部EAP廠商）:
  ❌ 專業心理諮商（需諮商心理師執照）
  ❌ 法律諮詢（需律師執照）
  ❌ 財務規劃（需理財規劃師）
  ❌ 危機干預（需專業訓練）
```

### 4.3 EAP 開源專案調研結果

#### 🔍 調研結論
經 GitHub 搜尋，**未找到專門的 EAP 管理系統開源專案**。

搜尋關鍵字 "Employee Assistance Program" 回傳的結果主要是：
- **EAP (Extensible Authentication Protocol)**：網路認證協議（802.1x）
- **一般 HR 管理系統**：人力資源、考勤、薪資系統

#### 💡 原因分析
1. **高度隱私性**：EAP 涉及員工心理健康紀錄，極少開源
2. **專業服務導向**：EAP 主要由專業機構提供服務，非軟體產品
3. **商業授權軟體**：商用 EAP 平台通常為 SaaS 服務（如 Lyra Health、Spring Health）

#### ✅ 替代方案
**選項A：整合商業EAP服務**
- 與專業 EAP 廠商合作（如鉅微、寬旭、張老師基金會）
- ESS 提供預約介面，實際諮商由廠商執行
- 優點：專業度高、符合心理師法規範
- 缺點：需支付服務費用

**選項B：建立輕量級EAP入口**
- ESS 僅作為「資源門戶」
- 提供文章、影片、外部諮詢熱線連結
- 記錄匿名化的使用次數（用於 ROI 分析）
- 優點：成本低、開發簡單
- 缺點：無法提供專業諮商

**選項C：參考開源 HR 系統自建**
- 參考 [OrangeHRM](https://github.com/orangehrm/orangehrm)（開源人資系統）的模組架構
- 自行開發 EAP 預約、資源管理模組
- 優點：客製化彈性高
- 缺點：開發成本高、需注意隱私法規

#### 📖 參考資料
- [Wikipedia: Employee Assistance Program](https://en.wikipedia.org/wiki/Employee_assistance_program)
- [OPM.gov: What is EAP?](https://www.opm.gov/frequently-asked-questions/work-life-faq/employee-assistance-program-eap/what-is-an-employee-assistance-program-eap/)
- [Bonterra: EAP Software Guide](https://www.bonterratech.com/blog/eap-software)

---

## 五、功能擴充優先級排序

基於**實施難度**、**資料可得性**、**學術依據**、**實用價值**四個維度評分：

### 📊 綜合評分矩陣

| 功能 | 實施難度 | 資料可得 | 學術依據 | 實用價值 | **總分** | **優先級** |
|------|---------|---------|---------|---------|---------|-----------|
| **Bradford Factor 缺勤指數** | ⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐ | **11/12** | 🥇 **P0** |
| **排班合規預警（七休一）** | ⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐ | ⭐⭐⭐ | **11/12** | 🥇 **P0** |
| **心情指數整合（ESS）** | ⭐⭐ | ⭐⭐ | ⭐⭐ | ⭐⭐ | **8/12** | 🥈 **P1** |
| **簡化版倦怠評估** | ⭐⭐ | ⭐ | ⭐⭐ | ⭐⭐ | **7/12** | 🥈 **P1** |
| **EAP 資源整合** | ⭐ | ⭐ | ⭐⭐⭐ | ⭐⭐ | **7/12** | 🥈 **P1** |
| **休假餘額追蹤** | ⭐⭐ | ⭐ | ⭐ | ⭐⭐⭐ | **7/12** | 🥉 **P2** |
| **完整 MBI 倦怠量表** | ⭐ | ⭐ | ⭐⭐⭐ | ⭐⭐ | **7/12** | 🥉 **P2** |
| **VFLI 視覺負荷指標** | ⭐ | ⭐ | ❌ | ⭐ | **3/12** | ⛔ **不建議** |
| **What-If ML 預測** | ❌ | ⭐ | ⭐⭐ | ⭐⭐⭐ | **6/12** | 🚧 **P3（長期）** |

*評分：⭐⭐⭐ 優秀 | ⭐⭐ 中等 | ⭐ 差 | ❌ 不可行*

### 🎯 分階段實施建議

#### **Phase 0（立即實施）- 2026年1-2月**
```yaml
目標: 基於現有資料，零額外資料蒐集

功能1: Bradford Factor 缺勤指數
  - 開發時間: 3-5天
  - 資料來源: 現有「狀態」欄位
  - 實施重點:
    * 統計每位員工的「病假」次數與天數
    * 計算 Bradford Score = S² × D
    * 設定門檻值（建議：200分觸發關懷提醒）
    * UI呈現：在員工卡片顯示分數與風險等級

功能2: 排班合規預警（七休一）
  - 開發時間: 5-7天
  - 資料來源: 現有「日期」+「狀態」欄位
  - 實施重點:
    * 計算連續工作天數
    * 檢查是否違反「7天內至少2天休息」
    * 檢查是否違反「連續工作不超過12天」（四週變形工時）
    * UI呈現：排班違規員工紅色警示清單
```

#### **Phase 1（需ESS串接）- 2026年2-3月**
```yaml
前置條件: 與 ESS 團隊協調 API 串接

功能3: 心情指數整合
  - 開發時間: 10-14天（含ESS開發）
  - 資料來源: ESS 簽到時新增心情選項
  - 實施重點:
    * ESS 端：簽到頁面加入1-10分心情選擇
    * API 設計：工時系統定期拉取心情資料
    * UI呈現：「平均心情指數」曲線圖、部門心情熱圖

功能4: 簡化版倦怠評估
  - 開發時間: 7天（含問卷）
  - 資料來源: ESS 每週彈出單題問卷
  - 實施重點:
    * 使用史丹佛單題倦怠量表（免費）
    * 每週五下班前彈出問卷（可選填）
    * 匿名化處理（主管僅看部門平均）
    * UI呈現：倦怠趨勢圖、高風險人數統計
```

#### **Phase 2（長期規劃）- 2026年Q2以後**
```yaml
條件: 需額外預算或外部合作

功能5: 完整 MBI 倦怠量表
  - 需購買授權
  - 每半年施測一次（非每日）

功能6: EAP 資源整合
  - 與專業EAP廠商合作
  - ESS 提供預約與資源查詢介面

功能7: What-If ML 預測
  - 需大量歷史資料
  - 需聘請 ML 工程師或委外開發
```

---

## 六、What-If 分析可行性評估

### 6.1 技術調研：ML 模型現況

#### 📚 學術研究（2024年最新）

根據2024年最新醫療人力疲勞預測研究，以下ML模型已被證實有效：

##### **1. Gradient Boosting Machine (GBM)** ⭐⭐⭐
- **應用案例**：2024年北京冬奧醫護人員疲勞預測
- **效果**：MRE = 0.207, R² = 0.812（表現最佳）
- **關鍵輸入變數**：
  - 連續工作時數
  - 防護衣穿著時長
  - 體力活動頻率
- **優點**：預測準確度高、可解釋性強
- **缺點**：需大量訓練資料（建議至少6個月歷史資料）

##### **2. Random Forest + Smartwatch Data** ⭐⭐
- **應用案例**：2024年急診醫護疲勞預測
- **資料來源**：智慧手錶生理訊號 + MFI疲勞量表
- **優點**：即時監測、個人化預測
- **缺點**：需員工配戴穿戴裝置

##### **3. 護理師倦怠預測（南非研究）** ⭐⭐
- **關鍵預測因子**：
  1. 疲勞評分（最重要）
  2. 對管理層的信心
  3. 管理層傾聽員工的程度
- **演算法**：Supervised ML（未明確指出模型）
- **洞察**：**心理因素比工時更具預測力**

#### 📖 參考資料
- [PMC: Fatigue analysis using GBM](https://pmc.ncbi.nlm.nih.gov/articles/PMC11026406/)
- [PMC: Smartwatch-based fatigue prediction](https://ncbi.nlm.nih.gov/pmc/articles/PMC10393460)
- [BMC: Nurse burnout prediction](https://bmchealthservres.biomedcentral.com/articles/10.1186/s12913-024-12184-5)

---

### 6.2 實施可行性分析

#### ⚠️ 澄清眼科的現實限制

考量到您的背景（**AI應用規劃師中級認證**但缺乏實作經驗），評估如下：

##### **iPAS AI應用規劃師能力範圍**
根據官方資訊，中級認證涵蓋：
- ✅ AI導入評估規劃
- ✅ 電腦視覺、生成式AI技術應用概念
- ✅ 多模態AI應用規劃
- ❌ **不包含**深度的模型開發與訓練

##### **實際開發需求 vs 現有能力**

| 任務 | 所需技能 | 您的能力 | 差距 |
|------|---------|---------|------|
| **資料前處理** | Python pandas | ⚠️ 基礎 | 需學習 |
| **特徵工程** | 統計學 + 領域知識 | ✅ 規劃能力 | 可勝任 |
| **模型訓練** | scikit-learn / XGBoost | ❌ 無經驗 | **高風險** |
| **模型調優** | Grid Search / 交叉驗證 | ❌ 無經驗 | **高風險** |
| **模型部署** | Flask / Docker | ❌ 無經驗 | **高風險** |

##### **時間成本估算**

假設您從零開始學習並開發：
```yaml
學習階段（ML基礎）:
  - Python科學計算（pandas, numpy）: 2週
  - scikit-learn 基礎: 2週
  - XGBoost / LightGBM: 1週
  - 模型評估與調優: 1週

開發階段:
  - 資料清理與探索: 1週
  - 特徵工程: 1週
  - 模型訓練與驗證: 2週
  - API 整合與部署: 2週

總計: 約3-4個月全職投入
```

**結論**：若只有您一人開發，**不建議現階段實施 ML 模型**。

---

### 6.3 替代方案：簡化版 What-If 分析

#### ✅ 推薦方案：規則式模擬（Rule-Based Simulation）

不使用 ML，改用**數學公式模擬**：

```javascript
// 簡化版 What-If 分析
function simulateWorkloadIncrease(currentData, increasePercentage) {
  const simulation = {
    currentStats: calculateCurrentStats(currentData),
    projectedStats: {}
  };

  // 假設1：門診量增加 → 工時線性增加
  const workHoursIncrease = increasePercentage * 0.8; // 80%轉化為工時
  simulation.projectedStats.avgWorkHours =
    simulation.currentStats.avgWorkHours * (1 + workHoursIncrease);

  // 假設2：加班費以1.34倍計算（勞基法）
  const overtimeIncrease = workHoursIncrease * 1.5; // 加班增幅較高
  simulation.projectedStats.overtimeCost =
    simulation.currentStats.overtimeCost * (1 + overtimeIncrease);

  // 假設3：VFLI（手術量 × 2.0精密係數）
  simulation.projectedStats.vfliRiskCount =
    Math.floor(simulation.currentStats.vfliRiskCount * (1 + increasePercentage));

  // 假設4：Bradford Score（經驗公式）
  // 工時增加 20% → Bradford Score 平均提升 15%
  simulation.projectedStats.avgBradfordScore =
    simulation.currentStats.avgBradfordScore * (1 + increasePercentage * 0.75);

  return simulation;
}
```

#### 💡 優點
- ✅ 開發時間：1-2週
- ✅ 可立即上線
- ✅ 邏輯透明、可向主管解釋
- ✅ 無需訓練資料

#### ⚠️ 缺點
- ❌ 精準度低於 ML 模型
- ❌ 無法捕捉複雜非線性關係
- ❌ 需要定期根據實際數據調整參數

#### 📈 呈現方式

```yaml
UI 設計:
  輸入區:
    - 門診量預估變動: [+20%] ▲▼
    - 手術量預估變動: [+15%] ▲▼

  輸出區（對比表）:
    指標               | 現況   | 預測   | 變化
    -------------------|--------|--------|--------
    平均工時/人/月     | 180h   | 216h   | +20% ⚠️
    預估加班費支出     | 50萬   | 67.5萬 | +35% 🔴
    VFLI 超標人數      | 5人    | 8人    | +60% 🔴
    Bradford 高風險人數 | 3人    | 5人    | +67% 🔴
    建議增聘人力       | -      | 2-3人  | -
```

---

### 6.4 長期規劃：委外 ML 開發

若未來仍希望導入 ML 模型，建議：

#### **選項A：委託學術單位合作**
- 聯繫中山大學、成功大學醫學資訊研究所
- 提供匿名化資料作為研究題材
- 學生開發模型，醫院獲得成果
- 優點：成本低、可產出論文提升醫院形象
- 缺點：時程不可控、需符合人體研究倫理審查

#### **選項B：外包 AI 顧問公司**
- 如：鉅微（與澄清眼科合作EAP廠商）、叡揚資訊
- 報價約：30-80萬（依複雜度）
- 優點：專業度高、時程可控
- 缺點：成本較高

#### **選項C：培訓內部 ML 工程師**
- 送您或其他同仁參加實作課程（如資策會、工研院）
- 時程：6個月至1年成長為獨立開發者
- 優點：長期自主維護能力
- 缺點：培訓期間其他專案進度會受影響

---

## 七、EAP 系統釋義與整合方案

### 7.1 ROI（投資報酬率）解釋

#### 💰 EAP ROI 計算公式

```
ROI = (EAP帶來的節省金額 - EAP成本) / EAP成本 × 100%

節省金額 = A + B + C
  A = 避免離職的成本節省 = (減少離職人數) × (單人替換成本*)
  B = 減少缺勤的成本節省 = (減少病假天數) × (日薪)
  C = 生產力提升價值 = (績效改善%) × (員工總薪資)

*單人替換成本 = 招募費 + 訓練費 + 生產力損失
                 = 約該職位年薪的 50-200%（視專業度）
```

#### 📊 實際案例（參考研究文獻）

假設澄清眼科導入 EAP：
```yaml
EAP 年度成本:
  - 每位員工 $2,000 元/年（含諮商、法律、財務服務）
  - 100位員工 = $200,000 元/年

預估效益（保守估計）:
  A. 避免離職:
     - 原離職率 15% → 降至 12%（減少3人）
     - 單人替換成本：護理師年薪60萬 × 100% = 60萬
     - 節省: 3人 × 60萬 = 180萬

  B. 減少病假:
     - 平均病假減少 2天/人/年
     - 100人 × 2天 × 日薪2,000元 = 40萬

  C. 生產力提升:
     - 倦怠降低 → 績效提升 5%
     - 100人 × 平均年薪50萬 × 5% = 250萬

總節省: 180萬 + 40萬 + 250萬 = 470萬
ROI = (470萬 - 20萬) / 20萬 = 2250%（約1:23）
```

**業界平均 ROI**：1:3 至 1:10（本案例為理想狀況）

---

### 7.2 ESS 與 EAP 整合架構圖

```
┌─────────────────────────────────────────────────┐
│            ESS 員工自助服務平台                  │
├─────────────────────────────────────────────────┤
│                                                  │
│  [出勤打卡]  [請假申請]  [加班申請]  [薪資查詢] │
│                                                  │
│  ┌──────────────────────────────────┐           │
│  │   🆕 員工健康模組（新增）         │           │
│  ├──────────────────────────────────┤           │
│  │  ✅ 每日心情打卡（1-10分）        │           │
│  │  ✅ 每週倦怠問卷（單題）          │           │
│  │  ✅ EAP 資源查詢（文章/影片）      │           │
│  │  ✅ EAP 諮商預約                  │◄─────────┼─ API 串接
│  │  ✅ 匿名反饋通道                  │           │
│  └──────────────────────────────────┘           │
└───────────────────┬─────────────────────────────┘
                    │ API
                    ▼
┌─────────────────────────────────────────────────┐
│         Checkinly 工時分析系統（本專案）         │
├─────────────────────────────────────────────────┤
│                                                  │
│  📊 資料來源:                                    │
│    - Excel 出勤明細（每月上傳）                  │
│    - ESS API（心情/倦怠即時資料）                │
│                                                  │
│  📈 分析功能:                                    │
│    - Bradford Factor 缺勤風險                   │
│    - 排班合規檢查                               │
│    - 心情 & 倦怠趨勢                            │
│    - 優先關注名單（綜合風險評分）               │
│    - What-If 模擬                               │
│                                                  │
│  🎯 輸出:                                        │
│    - 管理層儀表板                               │
│    - 風險預警通知                               │
│    - EAP 使用率 vs 留任率分析                   │
│                                                  │
└─────────────────────────────────────────────────┘
                    │
                    ▼
┌─────────────────────────────────────────────────┐
│        外部 EAP 服務商（選配）                    │
├─────────────────────────────────────────────────┤
│  - 專業心理諮商（鉅微/張老師基金會）            │
│  - 法律諮詢                                      │
│  - 財務規劃                                      │
│  - 危機干預                                      │
└─────────────────────────────────────────────────┘
```

---

### 7.3 實施建議

#### **最小可行方案（MVP）**

```yaml
Phase 1（無需外部EAP廠商）:
  1. ESS 新增功能:
     - 每日心情打卡（下拉選單 1-10分）
     - EAP 資源頁面（靜態文章連結）

  2. Checkinly 新增功能:
     - 拉取 ESS 心情資料
     - 呈現「平均心情指數」曲線
     - 部門心情熱圖

  3. 資料流:
     ESS → MySQL → API → Checkinly → 視覺化

Phase 2（與EAP廠商合作）:
  1. ESS 新增功能:
     - EAP 諮商預約系統
     - 匿名回饋表單

  2. 外部廠商提供:
     - 諮商師團隊
     - 個案管理系統（保密）

  3. Checkinly 新增功能:
     - EAP 使用率統計（去識別化）
     - EAP ROI 分析（使用率 vs 留任率）
```

---

## 八、實施時程與資源評估

### 8.1 階段性開發時程（保守估計）

```
Phase 0: 基礎功能
  └─ Bradford Factor計算       (2026-01-06 起 5天)
     └─ 排班合規檢查            (完成後 7天)
        └─ UI整合與測試         (完成後 3天)

Phase 1: ESS串接
  └─ ESS團隊需求確認           (2026-01-20 起 3天)
     └─ ESS開發（心情打卡）     (完成後 10天)
        └─ API設計與串接        (完成後 5天)
           └─ 簡化版倦怠問卷    (2026-02-03 起 7天)
              └─ 整合測試       (完成後 5天)

Phase 2: 完善與上線
  └─ 深色模式（選配）          (2026-02-17 起 5天)
     └─ 健康天氣條組件          (完成後 5天)
        └─ 優先關注名單         (完成後 7天)
           └─ UAT & 上線準備    (完成後 7天)
              └─ 正式上線 🎯    (2026-03-20)
```

### 8.2 人力資源需求

#### **最小團隊配置**

```yaml
核心開發人員:
  - 前端工程師（您）: 1人
    * 負責: Checkinly 功能開發、UI/UX優化
    * 技能: React + JavaScript

ESS 團隊協作（需協調）:
  - ESS 後端工程師: 0.5人（兼職協助）
    * 負責: PHP API開發、資料庫調整
    * 估計工時: 40-60小時

  - ESS 前端工程師: 0.5人（兼職協助）
    * 負責: ExtJS頁面修改（心情打卡介面）
    * 估計工時: 30-40小時

顧問支援（選配）:
  - HR顧問: 協助Bradford Factor門檻值設定
  - 法務顧問: 確認勞基法合規檢查邏輯
```

#### **技能缺口與學習計畫**

針對您的 AI 應用規劃師背景：

```yaml
現有能力:
  ✅ AI導入評估與規劃
  ✅ React 前端開發
  ✅ 資料視覺化（Recharts）

需補強（短期）:
  ⚠️ PHP基礎（若需修改ESS）: 2-3天線上課程
  ⚠️ MySQL查詢優化: 1-2天
  ⚠️ RESTful API設計: 3天

長期選修（若要做ML）:
  📚 Python數據分析: 2週
  📚 scikit-learn實作: 2週
  📚 XGBoost進階: 1週
```

---

### 8.3 風險評估與應對

| 風險 | 機率 | 影響 | 應對策略 |
|------|------|------|---------|
| **ESS團隊資源不足** | 高 | 高 | 提前2週協調排程、強調業務價值 |
| **資料品質問題** | 中 | 中 | 先用10月資料測試、建立清洗流程 |
| **Bradford門檻設定爭議** | 中 | 中 | 參考UK標準，由HR與主管共同決定 |
| **員工隱私疑慮** | 低 | 高 | 心情資料匿名化、僅呈現部門平均 |
| **時程延遲** | 中 | 中 | 優先P0功能、P1功能可延後至Q2 |

---

## 九、建議與結論

### 9.1 關鍵建議

#### ✅ **建議採納的功能（高ROI）**

1. **Bradford Factor 缺勤指數**
   - ✓ 有國際標準
   - ✓ 現有資料即可計算
   - ✓ 可作為關懷觸發機制
   - 實施難度：⭐⭐☆☆☆

2. **排班合規預警（七休一）**
   - ✓ 有明確法規依據
   - ✓ 避免違法罰款（最高30萬）
   - ✓ 保護員工權益
   - 實施難度：⭐⭐☆☆☆

3. **心情指數整合（透過ESS）**
   - ✓ 低成本實施
   - ✓ 即時性高
   - ⚠️ 需ESS團隊配合
   - 實施難度：⭐⭐⭐☆☆

4. **簡化版 What-If 分析（規則式）**
   - ✓ 輔助決策價值高
   - ✓ 開發成本可控
   - ⚠️ 精準度低於ML
   - 實施難度：⭐⭐⭐☆☆

#### ❌ **不建議採納的功能**

1. **VFLI 視覺負荷指標**
   - ✗ 無學術依據
   - ✗ 自創公式缺乏公信力
   - ✗ 不適合國際醫院形象
   - **替代方案**：直接使用「連續顯微鏡使用時數」

2. **完整 ML 預測模型（現階段）**
   - ✗ 開發成本過高（3-4個月全職）
   - ✗ 超出現有團隊能力
   - ✗ 資料累積不足
   - **替代方案**：先用規則式模擬，長期委外開發

---

### 9.2 給主管的決策建議

#### 📋 需要您確認的事項

1. **優先級確認**
   ```
   □ 同意優先開發 Phase 0 功能（Bradford + 排班合規）
   □ 希望調整優先順序，改為 _________________
   ```

2. **ESS 串接協調**
   ```
   □ 已與 ESS 團隊確認可配合開發（預計 __ 小時）
   □ ESS 團隊人力不足，建議調整策略
   □ 需安排跨部門會議討論
   ```

3. **EAP 資源規劃**
   ```
   □ 澄清眼科已有合作 EAP 廠商：_________________
   □ 尚未有 EAP 廠商，請協助推薦
   □ 短期僅做 ESS 內部資源整合即可
   ```

4. **資料來源確認**
   ```
   □ 每月出勤 Excel 可繼續提供
   □ 需要額外提供：□手術量資料 □其他：_______
   □ 心情指數由 ESS 簽到時蒐集
   □ Bradford Factor 的病假資料已包含在現有 Excel
   ```

5. **預算與資源**
   ```
   □ 預算範圍：__ 萬元（若需外部顧問/EAP廠商）
   □ 可接受時程：2026年 __ 月完成第一階段
   □ ESS團隊協作工時：可支援 __ 小時
   ```

6. **MBI 倦怠量表決策**
   ```
   □ 購買正版 MBI 授權（每次施測約 __ 元/人）
   □ 使用免費替代量表（如CBI）
   □ 僅使用簡化版單題問卷
   ```

---

### 9.3 實施路線圖總結

```
現在
 │
 ├─ Phase 0 (立即實施)
 │   ├─ Bradford Factor
 │   └─ 排班合規檢查
 │
 ├─ Phase 1 (ESS 串接)
 │   ├─ 心情指數
 │   └─ 簡化倦怠問卷
 │
 ├─ Phase 2 (完善功能)
 │   ├─ 深色模式
 │   ├─ 優先關注名單
 │   └─ What-If 規則式
 │
 ├─ 2026 Q1 上線 🎯
 │
 └─ Phase 3 (長期規劃)
     ├─ 完整 MBI 量表
     ├─ 外部 EAP 整合
     └─ ML 預測模型（委外開發）
```

---

### 9.4 最終建議

基於本次深度調研，我們的核心建議是：

1. **先求有再求好**：優先實施有明確標準的功能（Bradford, 排班合規）
2. **避免學術風險**：不實施無論文依據的自創指標（VFLI）
3. **善用現有資源**：整合 ESS 平台而非重複開發
4. **保留未來彈性**：ML 預測作為長期目標，短期用規則式替代

預計在 **2026年3月下旬** 可完成：
- ✅ Bradford Factor 自動計算與警示
- ✅ 排班合規預警（七休一檢查）
- ✅ 心情指數趨勢圖（需ESS配合）
- ✅ 簡化版倦怠評估
- ✅ 基礎 UI/UX 優化

此階段完成後，系統將從「工時記錄工具」升級為「員工健康預警平台」，為後續導入完整 EAP 方案奠定基礎。

---

**報告完畢，靜候指示。**

---

## 📚 附錄：完整參考資料

### Bradford Factor
- [IRIS HR: What is the Bradford Factor?](https://www.iris.co.uk/blog/hr/absence-management-what-is-the-bradford-factor/)
- [Breathe HR: Bradford Factor Calculator](https://www.breathehr.com/en-gb/bradford-factor-calculator)
- [Wikipedia: Bradford Factor](https://en.wikipedia.org/wiki/Bradford_Factor)

### MBI 倦怠量表
- [Mind Garden: MBI Official Website](https://www.mindgarden.com/117-maslach-burnout-inventory-mbi)
- [PMC: MBI Psychometric Properties](https://pmc.ncbi.nlm.nih.gov/articles/PMC8829575/)
- [NAM: Valid Survey Instruments for Burnout](https://nam.edu/valid-reliable-survey-instruments-measure-burnout-well-work-related-dimensions/)

### 台灣勞基法
- [衛福部：護理排班問答與指引](https://www.mohw.gov.tw/dl-47213-037e2918-7f19-443d-9114-5d069559e373.html)
- [勞動部：工時制度及工作彈性化](https://www.mol.gov.tw/1607/28162/28166/28218/28220/32907/)
- [勞基法排班規定懶人包](https://salaryback.com/article/post-how-to-arrange-vacations-under-the-labor-standards-law/)

### ML 疲勞預測研究（2024）
- [PMC: Fatigue analysis using GBM](https://pmc.ncbi.nlm.nih.gov/articles/PMC11026406/)
- [PMC: Smartwatch-based fatigue prediction](https://ncbi.nlm.nih.gov/pmc/articles/PMC10393460)
- [BMC: Nurse burnout prediction](https://bmchealthservres.biomedcentral.com/articles/10.1186/s12913-024-12184-5)
- [PNAS: Wearable network for fatigue prediction](https://academic.oup.com/pnasnexus/article/3/10/pgae421/7815440)

### EAP 相關
- [Wikipedia: Employee Assistance Program](https://en.wikipedia.org/wiki/Employee_assistance_program)
- [OPM.gov: What is EAP?](https://www.opm.gov/frequently-asked-questions/work-life-faq/employee-assistance-program-eap/what-is-an-employee-assistance-program-eap/)

### AI 應用規劃師
- [iPAS 官網：AI應用規劃師專區](https://www.ipas.org.tw/AIAP/)
- [數位時代：AI應用規劃師考照攻略](https://www.bnext.com.tw/article/82484/ai-master-2025)

---

**撰寫日期**：2026年1月4日
**版本**：v1.0
**下次檢討**：Phase 0 完成後（預計 2026年2月）
