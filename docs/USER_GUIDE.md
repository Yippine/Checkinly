# Checkinly 使用者操作手冊
## User Guide

Version: 1.0.0-MVP
Last Updated: 2026-01-07

---

## 目錄 (Table of Contents)

1. [系統概述](#系統概述)
2. [快速開始](#快速開始)
3. [資料上傳與解析](#資料上傳與解析)
4. [功能使用說明](#功能使用說明)
   - [Bradford Factor 分析](#bradford-factor-分析)
   - [排班合規檢查](#排班合規檢查)
   - [心情指數追蹤](#心情指數追蹤)
   - [倦怠評估系統](#倦怠評估系統)
5. [常見問題 (FAQ)](#常見問題)
6. [故障排除](#故障排除)

---

## 系統概述

### 系統目的
Checkinly 是一個專業級工時分析與員工健康監測平台，專為企業 HR 和管理階層設計，提供：
- 出勤數據分析與視覺化
- Bradford Factor 缺勤風險評估
- 排班合規自動檢查
- 員工心情與倦怠追蹤
- 智能管理建議

### 目標使用者
- HR 專業人員
- 部門主管
- 企業管理階層
- 員工關懷專員

### 核心功能
1. **資料解析**: 支援 Excel / CSV 檔案上傳與自動欄位映射
2. **統計分析**: 自動計算工時、加班、缺勤等關鍵指標
3. **風險識別**: Bradford Factor、排班合規、倦怠評估
4. **視覺化**: 互動式圖表與儀表板
5. **建議系統**: 基於數據的管理建議

---

## 快速開始

### 系統需求
- 現代瀏覽器 (Chrome, Firefox, Safari, Edge 最新版)
- 網路連線 (首次載入)
- Excel 2007+ (.xlsx) 或 CSV 檔案

### 5 分鐘快速上手
1. 開啟 Checkinly 網站
2. 準備出勤 Excel 檔案（必須包含：員工編號、日期、工時等欄位）
3. 點擊上傳區域或拖曳檔案
4. 查看自動生成的分析報表
5. 瀏覽各項功能頁面

---

## 資料上傳與解析

### 支援檔案格式
- **Excel**: .xlsx (推薦)
- **CSV**: .csv (支援 UTF-8 和 Big5 編碼)

### 必要欄位
系統會自動識別以下欄位（不分大小寫，支援中英文）：

| 功能 | 必要欄位 | 可選欄位 |
|------|---------|---------|
| 基本分析 | 員工編號, 日期, 工作時數 | 部門, 員工姓名, 加班時數 |
| Bradford Factor | 員工編號, 日期, 出勤狀態 | - |
| 排班合規 | 員工編號, 日期 | - |
| 心情指數 | 員工編號, 日期, 心情指數 | - |

### 上傳步驟
1. **方法一：點擊上傳**
   - 點擊「選擇檔案」按鈕
   - 瀏覽並選擇檔案
   - 等待解析完成

2. **方法二：拖曳上傳**
   - 直接將檔案拖曳到上傳區域
   - 系統自動開始解析

### 解析狀態
- **解析中**: 顯示進度動畫
- **成功**: 自動跳轉至儀表板
- **失敗**: 顯示錯誤訊息與建議

### 常見解析問題
- **編碼錯誤**: CSV 檔案請確認為 UTF-8 或 Big5 編碼
- **欄位缺失**: 檢查必要欄位是否存在
- **日期格式**: 建議使用 YYYY-MM-DD 或 YYYY/MM/DD 格式
- **數值格式**: 工時請使用數字，非文字

---

## 功能使用說明

### Bradford Factor 分析

#### 什麼是 Bradford Factor？
Bradford Factor 是一種量化缺勤影響的指標，由英國布拉德福德大學開發。其核心概念是：**短期頻繁缺勤對組織的影響大於單次長期缺勤**。

#### 計算公式
```
Bradford Factor = S² × D

where:
  S = Spells (缺勤次數/期數)
  D = Days (缺勤總天數)
```

#### 範例
- **情況 A**: 員工請假 1 次，共 10 天
  - Bradford Factor = 1² × 10 = **10**

- **情況 B**: 員工請假 10 次，每次 1 天，共 10 天
  - Bradford Factor = 10² × 10 = **1000**

雖然總缺勤天數相同，但情況 B 的分數遠高於情況 A，因為頻繁的短期缺勤對工作安排和團隊運作造成更大困擾。

#### 風險等級
- **0-50**: 低風險 (綠色) - 正常範圍
- **50-100**: 中風險 (黃色) - 需要關注
- **100+**: 高風險 (紅色) - 需立即介入

#### 如何使用
1. 上傳包含「出勤狀態」欄位的檔案
2. 系統自動識別缺勤記錄（關鍵字：缺勤、請假、病假、事假）
3. 查看優先關注名單，Bradford Factor 高分者會排在前面
4. 點擊員工查看詳細缺勤記錄

#### 管理建議
- **50-100 分**: 進行一對一談話，瞭解缺勤原因
- **100-200 分**: 啟動正式關懷流程，可能需要 HR 介入
- **200+ 分**: 嚴重情況，需檢討工作適配性或健康問題

---

### 排班合規檢查

#### 法規依據
- **勞動基準法第 36 條**: 勞工每七日中應有二日之休息，其中一日為例假，一日為休息日（七休一）
- **醫療變形工時**: 醫療保健服務業可延長至 12 日

#### 檢查邏輯
系統自動計算每位員工的連續工作天數：
- **≤ 6 天**: 符合法規 (綠色)
- **7 天**: 臨界值 (黃色警告)
- **8-12 天**: 違規 (紅色) - 除非適用醫療變形工時
- **> 12 天**: 嚴重違規 (深紅色)

#### 如何使用
1. 上傳出勤資料（需包含日期欄位）
2. 查看優先關注名單，排班違規者會標記為「排班違規」
3. 健康天氣條會顯示紅色警示
4. 點擊員工查看詳細排班記錄

#### 管理建議
- **7 天**: 注意下週排班，確保給予休息日
- **8+ 天**: 立即調整排班，避免勞檢罰款
- **持續違規**: 檢討排班系統與人力配置

---

### 心情指數追蹤

#### 功能說明
心情指數是員工自評的情緒狀態指標，範圍 1-10 分：
- **1-3**: 情緒低落
- **4-6**: 普通
- **7-10**: 情緒良好

#### 資料準備
1. 在 Excel 檔案中新增「心情指數」欄位（或使用 "Mood Score"）
2. 請員工每日填寫 1-10 的分數
3. 上傳檔案至系統

詳細設定請參考 README.md 中的「心情指數欄位設定指南」

#### 圖表說明
1. **個人心情趨勢圖**
   - X 軸: 日期
   - Y 軸: 心情分數
   - 紅線: 警戒線 (分數 4)

2. **部門平均心情圖**
   - 比較各部門的平均心情指數
   - 識別情緒低落的部門

#### 如何解讀
- **趨勢下降**: 可能面臨工作壓力或個人問題
- **持續低分 (< 4)**: 需立即關懷與支援
- **部門整體低分**: 檢討部門工作環境與管理方式

#### 管理建議
- **個人低分**: 一對一談話，提供 EAP 資源
- **部門低分**: 召開部門會議，瞭解問題根源
- **趨勢監控**: 定期追蹤，建立心理健康支援機制

---

### 倦怠評估系統

#### 功能概述
提供三種科學驗證的倦怠評估問卷：
1. **Stanford 單題問卷** - 快速篩檢
2. **CBI 哥本哈根倦怠量表** - 全面評估
3. **OLBI 奧爾登堡倦怠量表** - 耗竭與疏離雙維度

#### Stanford 單題問卷

**使用時機**: 快速篩檢、定期追蹤

**問題**: "整體而言，根據您對倦怠的理解，您會如何評估您的倦怠程度？"

**量尺**: 1-7 分
- 1: 完全沒有倦怠
- 4: 中度倦怠
- 7: 嚴重倦怠

**操作步驟**:
1. 點擊側邊欄「倦怠評估」
2. 選擇 Stanford 問卷
3. 選擇分數
4. 點擊「提交」
5. 查看即時反饋與建議

#### CBI 哥本哈根倦怠量表

**使用時機**: 全面評估、年度健檢

**維度**:
- 個人倦怠 (Personal Burnout)
- 工作相關倦怠 (Work-related Burnout)
- 客戶相關倦怠 (Client-related Burnout)

**題數**: 19 題

**量尺**: 5-point frequency scale
- Always / Often / Sometimes / Seldom / Never/Almost never

**操作步驟**:
1. 選擇 CBI 問卷
2. 依序回答 19 個問題（約需 5-10 分鐘）
3. 提交後查看各維度分數
4. 系統自動儲存結果

**分數解讀**:
- < 50: 低倦怠
- 50-75: 中度倦怠
- > 75: 高倦怠

#### OLBI 奧爾登堡倦怠量表

**使用時機**: 評估耗竭與疏離感、研究用途

**維度**:
- 耗竭 (Exhaustion): 身體與情緒的疲憊感
- 疏離 (Disengagement): 對工作的消極與距離感

**題數**: 16 題 (每維度 8 題)

**量尺**: 4-point agreement scale
- Strongly Agree / Agree / Disagree / Strongly Disagree

**操作步驟**:
1. 選擇 OLBI 問卷
2. 回答 16 個問題（約需 5-8 分鐘）
3. 提交後查看雙維度分數

**分數解讀**:
- < 2.25: 低倦怠
- 2.25-2.75: 中度倦怠
- > 2.75: 高倦怠

#### 倦怠趨勢追蹤

**功能**:
- 時間序列圖表顯示倦怠分數變化
- 自動標記風險等級
- 統計低/中/高風險比例

**如何使用**:
1. 定期填寫倦怠問卷（建議每月或每季）
2. 查看「倦怠趨勢」頁面
3. 觀察分數變化趨勢
4. 關注風險等級轉變

**管理建議**:
- **趨勢上升**: 評估工作負荷與壓力源
- **高風險**: 提供專業心理諮詢資源
- **部門統計**: 識別高風險部門，進行組織干預

#### 資料隱私
- 所有問卷資料儲存於瀏覽器本地 (localStorage)
- 不會上傳至伺服器
- 使用者可隨時清除資料

---

## 常見問題 (FAQ)

### 一般問題

**Q1: 系統支援哪些檔案格式？**
A: 支援 Excel (.xlsx) 和 CSV (.csv) 格式。推薦使用 Excel 以獲得最佳相容性。

**Q2: 檔案大小有限制嗎？**
A: 建議單一檔案不超過 10MB。對於大型資料集（> 5000 筆），載入時間可能較長。

**Q3: 資料會儲存在哪裡？**
A:
- 上傳的檔案僅在瀏覽器中處理，不會上傳至伺服器
- 倦怠問卷資料儲存於瀏覽器 localStorage
- 清除瀏覽器快取會刪除問卷資料

**Q4: 可以同時上傳多個檔案嗎？**
A: 目前僅支援單一檔案上傳。如需合併多個檔案，請先在 Excel 中合併後再上傳。

### 資料問題

**Q5: 為什麼上傳後沒有顯示心情指數圖表？**
A: 請檢查：
1. Excel 檔案中是否有「心情指數」或「Mood Score」欄位
2. 欄位名稱是否正確（不分大小寫）
3. 欄位中是否有數值資料

**Q6: Bradford Factor 分數為什麼是 0？**
A: 可能原因：
1. 沒有缺勤記錄
2. 出勤狀態欄位未正確識別缺勤（請使用「缺勤」、「請假」、「病假」等關鍵字）
3. 日期範圍問題

**Q7: 排班合規檢查沒有顯示警示？**
A: 請確認：
1. 日期欄位格式正確
2. 資料涵蓋足夠的時間範圍（至少 2 週）
3. 確實有連續工作超過 6 天的情況

### 功能問題

**Q8: 倦怠問卷填寫到一半可以暫存嗎？**
A: 目前不支援暫存，請一次完成問卷填寫。

**Q9: 如何匯出分析結果？**
A: 目前版本不支援匯出功能。您可以使用瀏覽器的截圖功能或列印為 PDF。

**Q10: 可以比較不同時期的資料嗎？**
A: 目前僅支援單一檔案分析。未來版本會加入時間序列比較功能。

### 技術問題

**Q11: 為什麼圖表顯示異常？**
A: 請嘗試：
1. 重新整理頁面
2. 清除瀏覽器快取
3. 使用其他瀏覽器
4. 檢查是否使用最新版本瀏覽器

**Q12: 系統運行很慢怎麼辦？**
A: 可能原因與解決方法：
1. 資料量過大：嘗試分批上傳
2. 瀏覽器效能：關閉不必要的分頁
3. 裝置效能：使用效能較佳的裝置

---

## 故障排除

### 檔案無法上傳

**症狀**: 點擊上傳後沒有反應或顯示錯誤

**解決步驟**:
1. 檢查檔案格式是否為 .xlsx 或 .csv
2. 檢查檔案是否損壞（嘗試在 Excel 中開啟）
3. 檢查檔案大小是否超過 10MB
4. 嘗試另存新檔後再上傳
5. 使用其他瀏覽器嘗試

### 資料解析錯誤

**症狀**: 上傳成功但顯示「解析失敗」

**解決步驟**:
1. 確認必要欄位存在（員工編號、日期、工時）
2. 檢查日期格式是否一致
3. 檢查數值欄位是否包含文字
4. 移除合併儲存格
5. 移除隱藏列或隱藏欄
6. 確保資料從第一列開始（或第二列，第一列為標題）

### 圖表不顯示

**症狀**: 頁面載入但圖表區域空白

**解決步驟**:
1. 重新整理頁面 (F5)
2. 檢查瀏覽器主控台是否有錯誤訊息 (F12)
3. 確認資料欄位完整
4. 清除瀏覽器快取
5. 更換瀏覽器

### 倦怠問卷無法提交

**症狀**: 點擊提交按鈕無反應

**解決步驟**:
1. 確認所有問題都已回答
2. 檢查瀏覽器是否阻擋 localStorage
3. 允許網站使用 localStorage（瀏覽器設定）
4. 清除 localStorage 後重試：
   - 開啟瀏覽器開發者工具 (F12)
   - Application > Local Storage > 刪除相關項目

### 效能問題

**症狀**: 系統運行緩慢、畫面卡頓

**解決步驟**:
1. 減少上傳資料量（分批處理）
2. 關閉其他佔用資源的應用程式
3. 更新瀏覽器至最新版本
4. 重新啟動瀏覽器
5. 使用效能較佳的裝置

### 聯絡支援

如果以上方法無法解決問題，請聯絡技術支援並提供：
1. 瀏覽器種類與版本
2. 錯誤訊息截圖
3. 問題發生步驟
4. 瀏覽器主控台錯誤訊息 (F12)

---

## 附錄

### 欄位識別對照表

| 功能欄位 | 支援的欄位名稱 (不分大小寫) |
|---------|---------------------------|
| 部門 | 部門, Department, Dept |
| 員工編號 | 員工編號, 員工ID, Employee ID, EmpID, EmployeeID |
| 員工姓名 | 員工姓名, 姓名, Name, Employee Name |
| 日期 | 日期, Date, 上班日期, Work Date |
| 上班時間 | 上班時間, Start Time, Clock In |
| 下班時間 | 下班時間, End Time, Clock Out |
| 工作時數 | 工作時數, 工時, Hours, Work Hours, Working Hours |
| 加班時數 | 加班時數, 加班, Overtime, OT Hours |
| 出勤狀態 | 出勤狀態, 狀態, Status, Attendance Status |
| 心情指數 | 心情指數, Mood Score, mood, 情緒 |

### 出勤狀態關鍵字

系統會自動識別以下關鍵字為缺勤：
- 缺勤
- 請假
- 病假
- 事假
- 特休
- 產假
- 陪產假
- 喪假
- 公假
- Absence
- Leave
- Sick Leave
- Personal Leave

### 風險等級配色

| 等級 | 顏色 | 應用場景 |
|------|------|---------|
| 安全 | 綠色 (#10b981) | Bradford < 50, 合規排班, 心情 > 7 |
| 警告 | 黃色 (#f59e0b) | Bradford 50-100, 7天工作, 心情 4-6 |
| 危險 | 紅色 (#ef4444) | Bradford > 100, 違規排班, 心情 < 4 |

---

**Checkinly User Guide v1.0.0-MVP**
建議定期更新以反映系統新功能與改進
